<?xml version="1.0"?> <!-- -*- mode: xml; -*- -->
<FWBuilderResources version="@VERSION@">
    <Target name="linux24">
      <description>Linux 2.4/2.6</description>
      <family>linux24</family>
      <dialog>linux24</dialog>

      <options>
        <user_can_change_install_dir>true</user_can_change_install_dir>
        <default>
          <linux24_ip_forward>1</linux24_ip_forward>
          <loopback_interface>lo</loopback_interface>
        </default>

        <activation>

          <fwdir>/etc/fw</fwdir>

          <fwdir_test>/tmp</fwdir_test>

          <timeout_units>min</timeout_units>

          <reg_user>
            <run>
              <copy>
%FWDIR%
              </copy>

              <compression>
echo '%FWBPROMPT%';
chmod +x %FWDIR%/%FWSCRIPT%;
sudo -S %FWDIR%/%FWSCRIPT% &#38;&#38; ( which pkill > /dev/null &#38;&#38; sudo -S pkill shutdown; echo 'Policy activated' )
              </compression>
              <no_compression>
echo '%FWBPROMPT%';
chmod +x %FWDIR%/%FWSCRIPT%;
sudo -S %FWDIR%/%FWSCRIPT% &#38;&#38; ( which pkill > /dev/null &#38;&#38; sudo -S pkill shutdown; echo 'Policy activated' )
              </no_compression>
            </run>

            <test>
              <copy>
%FWDIR%/tmp
              </copy>

              <rollback>
echo '%FWBPROMPT%';
echo 'sudo -S /sbin/shutdown -r +%RBTIMEOUT%'|batch;
chmod +x %FWDIR%/tmp/%FWSCRIPT%;
sudo -S %FWDIR%/tmp/%FWSCRIPT% &#38;&#38; echo 'Policy activated'
              </rollback>
              <no_rollback>
echo '%FWBPROMPT%';
chmod +x %FWDIR%/tmp/%FWSCRIPT%;
sudo -S %FWDIR%/tmp/%FWSCRIPT% &#38;&#38; echo 'Policy activated'
              </no_rollback>
            </test>
          </reg_user>

          <root>
            <run>
              <copy>
%FWDIR%
              </copy>

              <compression>
echo '%FWBPROMPT%';
sh %FWDIR%/%FWSCRIPT% &#38;&#38; ( which pkill > /dev/null &#38;&#38; pkill shutdown; echo 'Policy activated' )
              </compression>
              <no_compression>
echo '%FWBPROMPT%';
sh %FWDIR%/%FWSCRIPT% &#38;&#38; ( which pkill > /dev/null &#38;&#38; pkill shutdown; echo 'Policy activated' )
              </no_compression>
            </run>

            <test>
              <copy>
%FWDIR%/tmp
              </copy>

              <rollback>
echo '%FWBPROMPT%';
echo '/sbin/shutdown -r +%RBTIMEOUT%'|batch;
sh %FWDIR%/tmp/%FWSCRIPT% &#38;&#38; echo 'Policy activated'
              </rollback>
              <no_rollback>
echo '%FWBPROMPT%';
sh %FWDIR%/tmp/%FWSCRIPT% &#38;&#38; echo 'Policy activated'
              </no_rollback>
            </test>

          </root>
        </activation>

<!-- set to True if you want to suppress comments in the generated script -->
        <suppress_comments>False</suppress_comments>
<!-- set to True if you do not need the script to load kernel modules -->
        <suppress_modules>False</suppress_modules>

      </options>

      <capabilities>
        <supports_routing>True</supports_routing>
      </capabilities>

      <tools>
        <RedHat>
          <path_lsmod>/sbin/lsmod</path_lsmod>
          <path_modprobe>/sbin/modprobe</path_modprobe>
          <path_iptables>/sbin/iptables</path_iptables>
          <path_ip6tables>/sbin/ip6tables</path_ip6tables>
          <path_iptables_restore>/sbin/iptables-restore</path_iptables_restore>
          <path_ip6tables_restore>/sbin/ip6tables-restore</path_ip6tables_restore>
          <path_ip>/sbin/ip</path_ip>
          <path_logger>/usr/bin/logger</path_logger>
          <path_expect>/usr/bin/expect</path_expect>
        </RedHat>
        <Mandrake>
          <path_lsmod>/sbin/lsmod</path_lsmod>
          <path_modprobe>/sbin/modprobe</path_modprobe>
          <path_iptables>/sbin/iptables</path_iptables>
          <path_ip6tables>/sbin/ip6tables</path_ip6tables>
          <path_iptables_restore>/sbin/iptables-restore</path_iptables_restore>
          <path_ip6tables_restore>/sbin/ip6tables-restore</path_ip6tables_restore>
          <path_ip>/sbin/ip</path_ip>
          <path_logger>/usr/bin/logger</path_logger>
          <path_expect>/usr/bin/expect</path_expect>
        </Mandrake>
        <SuSE>
          <path_lsmod>/sbin/lsmod</path_lsmod>
          <path_modprobe>/sbin/modprobe</path_modprobe>
          <path_iptables>/usr/sbin/iptables</path_iptables>
          <path_ip6tables>/usr/sbin/ip6tables</path_ip6tables>
          <path_iptables_restore>/usr/sbin/iptables-restore</path_iptables_restore>
          <path_ip6tables_restore>/sbin/ip6tables-restore</path_ip6tables_restore>
          <path_ip>/sbin/ip</path_ip>
          <path_logger>/bin/logger</path_logger>
          <path_expect>/usr/bin/expect</path_expect>
        </SuSE>
        <Debian>
          <path_lsmod>/sbin/lsmod</path_lsmod>
          <path_modprobe>/sbin/modprobe</path_modprobe>
          <path_iptables>/sbin/iptables</path_iptables>
          <path_ip6tables>/sbin/ip6tables</path_ip6tables>
          <path_iptables_restore>/sbin/iptables-restore</path_iptables_restore>
          <path_ip6tables_restore>/sbin/ip6tables-restore</path_ip6tables_restore>
          <path_ip>/sbin/ip</path_ip>
          <path_logger>/usr/bin/logger</path_logger>
          <path_expect>/usr/bin/expect</path_expect>
        </Debian>
        <Unknown>
          <path_lsmod>lsmod</path_lsmod>
          <path_modprobe>modprobe</path_modprobe>
          <path_iptables>iptables</path_iptables>
          <path_ip6tables>ip6tables</path_ip6tables>
          <path_iptables_restore>iptables-restore</path_iptables_restore>
          <path_ip6tables_restore>/sbin/ip6tables-restore</path_ip6tables_restore>
          <path_ip>ip</path_ip>
          <path_logger>logger</path_logger>
          <path_expect>/usr/bin/expect</path_expect>
        </Unknown>
      </tools>
    </Target>

</FWBuilderResources>
