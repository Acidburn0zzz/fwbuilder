<?xml version="1.0"?> <!-- -*- mode: xml; -*- -->
<FWBuilderResources>
    <Target name="openbsd">
      <description>OpenBSD</description>
      <status>active</status>
      <family>openbsd</family>
      <dialog>openbsd</dialog>
      <interface_dialog>openbsd</interface_dialog>
      <cluster_dialog>basic</cluster_dialog>

      <options>
        <user_can_change_install_dir>true</user_can_change_install_dir>
        <default>
          <openbsd_ip_forward>1</openbsd_ip_forward>
          <loopback_interface>lo0</loopback_interface>
        </default>

        <activation>

          <fwdir>/etc/fw</fwdir>

          <fwdir_test>/tmp</fwdir_test>

          <timeout_units>min</timeout_units>

          <reg_user>
            <run>
              <copy>
%FWDIR%
              </copy>

              <compression>
echo '%FWBPROMPT%';
chmod +x %FWDIR%/%FWSCRIPT%;
sudo -S %FWDIR%/%FWSCRIPT% &#38;&#38; sudo -S pkill shutdown; echo 'Policy activated'
              </compression>
              <no_compression>
echo '%FWBPROMPT%';
chmod +x %FWDIR%/%FWSCRIPT%;
sudo -S %FWDIR%/%FWSCRIPT% &#38;&#38; sudo -S pkill shutdown; echo 'Policy activated'
              </no_compression>
            </run>

            <test>
              <copy>
%FWDIR%/tmp
              </copy>

              <rollback>
echo '%FWBPROMPT%';
chmod +x %FWDIR%/tmp/%FWSCRIPT%;
sudo -S /sbin/shutdown -r +%RBTIMEOUT%;
sudo -S %FWDIR%/tmp/%FWSCRIPT% &#38;&#38; echo 'Policy activated'
              </rollback>
              <no_rollback>
echo '%FWBPROMPT%';
chmod +x %FWDIR%/tmp/%FWSCRIPT%;
sudo -S %FWDIR%/tmp/%FWSCRIPT% &#38;&#38; echo 'Policy activated'
              </no_rollback>
            </test>
          </reg_user>

          <root>
            <run>
              <copy>
%FWDIR%
              </copy>

              <compression>
echo '%FWBPROMPT%';
sh %FWDIR%/%FWSCRIPT% &#38;&#38; pkill shutdown; echo 'Policy activated'
              </compression>
              <no_compression>
echo '%FWBPROMPT%';
sh %FWDIR%/%FWSCRIPT% &#38;&#38; pkill shutdown; echo 'Policy activated'
              </no_compression>
            </run>

            <test>
              <copy>
%FWDIR%/tmp
              </copy>

              <rollback>
echo '%FWBPROMPT%';
/sbin/shutdown -r +%RBTIMEOUT%;
sh %FWDIR%/tmp/%FWSCRIPT% &#38;&#38; echo 'Policy activated'
              </rollback>
              <no_rollback>
echo '%FWBPROMPT%';
sh %FWDIR%/tmp/%FWSCRIPT% &#38;&#38; echo 'Policy activated'
              </no_rollback>
            </test>

          </root>
        </activation>
      </options>

      <capabilities>
        <supports_routing>False</supports_routing>
        <supports_subinterfaces>True</supports_subinterfaces>
        <supports_cluster>True</supports_cluster>
      </capabilities>

      <protocols>
        <failover>
          <string>carp,CARP</string>
          <string>none,None</string>
        </failover>
        <state_sync>
          <string>pfsync,pfsync</string>
        </state_sync>

        <pfsync>
          <needs_master>False</needs_master>
          <manage_addresses>True</manage_addresses>
        </pfsync>
        <carp>
          <needs_master>True</needs_master>
          <manage_addresses>True</manage_addresses>
        </carp>
      </protocols>

      <interfaces>
        <cluster>
          <string>carp,CARP</string>
        </cluster>
        <firewall>
          <string>ethernet,Ethernet</string>
        </firewall>
      </interfaces>

      <subinterfaces>
        <ethernet>
          <string>8021q,VLAN</string>
          <string>unknown,Unknown</string>
        </ethernet>
      </subinterfaces>

      <tools>
        <path_pfctl>/sbin/pfctl</path_pfctl>
        <path_sysctl>/sbin/sysctl</path_sysctl>
        <path_logger>/usr/bin/logger</path_logger>
        <path_expect>/usr/bin/expect</path_expect>
      </tools>
    </Target>

</FWBuilderResources>
